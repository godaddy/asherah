<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background-color: rgb(255, 255, 255);" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1067px" height="825px" viewBox="-0.5 -0.5 1067 825"><defs/><g><path d="M 80.59 180 L 80.59 200.35 L 80.59 203.4" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 80.59 208.65 L 77.09 201.65 L 80.59 203.4 L 84.09 201.65 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1" y="100" width="160" height="80" rx="7" ry="7" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="none"/><g transform="translate(2.5,104.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="156" height="70" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 156px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Load DRR from data persistence</div><div><br /></div><div>Extract IK metadata from DRR<br /></div></div></div></foreignObject><text x="78" y="41" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 131 260 L 254.63 260" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 259.88 260 L 252.88 263.5 L 254.63 260 L 252.88 256.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(187.5,254.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">NO</div></div></foreignObject><text x="8" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">NO</text></switch></g><path d="M 80.59 310 L 80.59 349.76 L 80.59 383.4" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 80.59 388.65 L 77.09 381.65 L 80.59 383.4 L 84.09 381.65 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(69.5,338.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">YES</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">YES</text></switch></g><path d="M 81 210 L 131 260 L 81 310 L 31 260 Z" fill="#fff2cc" stroke="#d6b656" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(58.5,246.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="45" height="27" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div align="center">Is IK <br /></div><div align="center">cached?</div></div></div></foreignObject><text x="23" y="20" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 411 260 L 484.13 260" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 489.38 260 L 482.38 263.5 L 484.13 260 L 482.38 256.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(422.5,254.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="34" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">Found</div></div></foreignObject><text x="17" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Found</text></switch></g><path d="M 335.88 210 L 335.88 149.76 L 335.88 96.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 335.88 90.88 L 339.38 97.88 L 335.88 96.13 L 332.38 97.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(306.5,147.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="56" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">Not Found</div></div></foreignObject><text x="28" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Not Found</text></switch></g><path d="M 336 210 L 411 260 L 336 310 L 261 260 Z" fill="#fff2cc" stroke="#d6b656" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(300.5,239.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="70" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 71px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Load specific</div><div>IK EKR from <br /></div><div>metastore<br /></div></div></div></foreignObject><text x="35" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 620.5 260 L 698.63 260" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 703.88 260 L 696.88 263.5 L 698.63 260 L 696.88 256.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="490.5" y="230" width="130" height="60" rx="7" ry="7" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="none"/><g transform="translate(499.5,246.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="110" height="27" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 111px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Extract SK metadata <br /></div><div>from IK EKR<br /></div></div></div></foreignObject><text x="55" y="20" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 805 260 L 899.13 260" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 904.38 260 L 897.38 263.5 L 899.13 260 L 897.38 256.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(830.5,255.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="18" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">NO</div></div></foreignObject><text x="9" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">NO</text></switch></g><path d="M 754.71 310 L 754.71 329.76 L 754.71 343.4" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 754.71 348.65 L 751.21 341.65 L 754.71 343.4 L 758.21 341.65 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(740.5,322.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">YES</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">YES</text></switch></g><path d="M 755 210 L 805 260 L 755 310 L 705 260 Z" fill="#fff2cc" stroke="#d6b656" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(732.5,246.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="45" height="27" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Is SK <br /></div><div>cached?<br /></div></div></div></foreignObject><text x="23" y="20" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 975.88 310 L 975.88 329.76 L 975.88 343.4" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 975.88 348.65 L 972.38 341.65 L 975.88 343.4 L 979.38 341.65 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(958.5,323.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="34" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">Found</div></div></foreignObject><text x="17" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Found</text></switch></g><path d="M 975.88 210 L 975.88 154.47 L 975.88 106.72" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 975.88 101.47 L 979.38 108.47 L 975.88 106.72 L 972.38 108.47 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(944.5,155.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="56" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">Not Found</div></div></foreignObject><text x="28" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Not Found</text></switch></g><path d="M 975.5 210 L 1045.5 260 L 975.5 310 L 905.5 260 Z" fill="#fff2cc" stroke="#d6b656" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(937.5,239.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="75" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 76px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Load specific</div><div>SK  EKR from</div><div>metastore<br /></div></div></div></foreignObject><text x="38" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 885.5 400.35 L 845.29 400.35 L 811.66 400.35" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 806.41 400.35 L 813.41 396.85 L 811.66 400.35 L 813.41 403.85 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="885.5" y="350" width="180" height="100" rx="7" ry="7" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="none"/><g transform="translate(886.5,371.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="56" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 176px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Use MK in HSM to decrypt SK</div><div><br /></div><div>If allowed by policy, add SK to protected memory cache<br /></div></div></div></foreignObject><text x="88" y="34" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 80.59 600 L 80.59 668.59 L 80.59 731.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 80.59 736.88 L 77.09 729.88 L 80.59 731.63 L 84.09 729.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 131.18 485.06 L 271.18 485.06 L 271.18 533.98" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 271.18 539.23 L 267.68 532.23 L 271.18 533.98 L 274.68 532.23 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(151.5,478.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">YES</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">YES</text></switch></g><path d="M 81 435.5 L 131 485.5 L 81 535.5 L 31 485.5 Z" fill="#fff2cc" stroke="#d6b656" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(57.5,471.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="27" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 47px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Is IK</div><div> expired?</div></div></div></foreignObject><text x="23" y="20" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 609.51 60.35 L 513.53 60.35 L 411 60.35" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 614.76 60.35 L 607.76 63.85 L 609.51 60.35 L 607.76 56.85 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="261" y="30" width="150" height="60" rx="7" ry="7" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="none"/><g transform="translate(262.5,39.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="146" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 146px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Throw ERROR:</div><div>Unable to decrypt DRK, missing IK from metadata<br /></div></div></div></foreignObject><text x="73" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 181 589.76 L 135.88 589.76 L 97.54 589.76" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 92.29 589.76 L 99.29 586.26 L 97.54 589.76 L 99.29 593.26 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="181" y="540" width="180" height="100" rx="7" ry="7" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="none"/><g transform="translate(191.5,554.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="158" height="70" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 159px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Send notification IK is expired</div><div><br /></div><div>Queue IK for rotation</div><div><br /></div><div>Queue DRK for rotation<br /></div></div></div></foreignObject><text x="79" y="41" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 161 773.29 L 293.53 773.29 L 418.93 773.29" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 424.18 773.29 L 417.18 776.79 L 418.93 773.29 L 417.18 769.79 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1" y="738" width="160" height="70" rx="7" ry="7" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="none"/><g transform="translate(14.5,752.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="133" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 134px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Use IK to decrypt DRK</div><div><br /></div><div>Use DRK to decrypt data<br /></div></div></div></foreignObject><text x="67" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 475.88 723 L 475.88 696.82 L 475.88 676.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 475.88 670.88 L 479.38 677.88 L 475.88 676.13 L 472.38 677.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(461.5,692.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">YES</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">YES</text></switch></g><path d="M 525.29 773.29 L 648.34 773.29" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 653.59 773.29 L 646.59 776.79 L 648.34 773.29 L 646.59 769.79 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(581.5,767.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">NO</div></div></foreignObject><text x="8" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">NO</text></switch></g><path d="M 475.5 723 L 525.5 773 L 475.5 823 L 425.5 773 Z" fill="#fff2cc" stroke="#d6b656" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(450.5,759.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="49" height="27" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Is DRK</div><div> expired?<br /></div></div></div></foreignObject><text x="25" y="20" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 705.29 742.22 L 705.29 640.35 L 525.29 640.35" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 705.29 747.47 L 701.79 740.47 L 705.29 742.22 L 708.79 740.47 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="425.5" y="610" width="100" height="60" rx="7" ry="7" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="none"/><g transform="translate(426.5,626.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="96" height="27" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 96px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Queue DRK for rotation</div></div></foreignObject><text x="48" y="20" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Queue DRK for rotation</text></switch></g><path d="M 755 450 L 755 493.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 755 498.88 L 751.5 491.88 L 755 493.63 L 758.5 491.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(744.5,466.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">YES</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">YES</text></switch></g><path d="M 705 400.35 L 670 400.35 L 641.87 400.35" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 636.62 400.35 L 643.62 396.85 L 641.87 400.35 L 643.62 403.85 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(661.5,394.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">NO</div></div></foreignObject><text x="8" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">NO</text></switch></g><path d="M 755 350 L 805 400 L 755 450 L 705 400 Z" fill="#fff2cc" stroke="#d6b656" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(731.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="27" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 47px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Is SK</div><div>expired?<br /></div></div></div></foreignObject><text x="23" y="20" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 655 560.35 L 545.29 560.35 L 545.29 451.43" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 545.29 446.18 L 548.79 453.18 L 545.29 451.43 L 541.79 453.18 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="655" y="500" width="200" height="120" rx="7" ry="7" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="none"/><g transform="translate(673.5,510.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="163" height="99" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 164px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Send notification SK is expired<div><br /></div><div>Queue SK for rotation</div><div><br /></div><div>Queue IK for rotation</div><div><br /></div><div>Queue DRK for rotation<br /></div></div></div></foreignObject><text x="82" y="56" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 455.5 400.35 L 273.53 400.35 L 97.54 400.35" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 92.29 400.35 L 99.29 396.85 L 97.54 400.35 L 99.29 403.85 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="455.5" y="355" width="180" height="90" rx="7" ry="7" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="none"/><g transform="translate(456.5,371.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="56" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 176px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Use SK to decrypt IK</div><div><br /></div><div>If allowed by policy, add IK to protected memory cache</div></div></div></foreignObject><text x="88" y="34" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 702.25 60.35 L 798.24 60.35 L 900.5 60.35" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 697 60.35 L 704 56.85 L 702.25 60.35 L 704 63.85 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="900.5" y="20" width="150" height="80" rx="7" ry="7" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="none"/><g transform="translate(901.5,39.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="146" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 146px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Throw ERROR:</div><div>Unable to decrypt DRK, missing IK from metadata<br /></div></div></div></foreignObject><text x="73" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 889.51 773.29 L 825.29 773.29 L 755 773.29" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 894.76 773.29 L 887.76 776.79 L 889.51 773.29 L 887.76 769.79 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="655" y="748" width="100" height="50" rx="7" ry="7" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="none"/><g transform="translate(658.5,759.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="92" height="27" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 93px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>Return decrypted</div><div>data<br /></div></div></div></foreignObject><text x="46" y="20" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 80.59 410 L 80.59 429.76 L 80.59 429.28" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 80.59 434.53 L 77.09 427.53 L 80.59 429.28 L 84.09 427.53 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="81" cy="400" rx="10" ry="10" fill="#ffffff" stroke="#000000" stroke-width="2" pointer-events="none"/><path d="M 73.86 407.14 L 88.14 392.86" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 73.86 392.86 L 88.14 407.14" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="81" cy="590" rx="10" ry="10" fill="#ffffff" stroke="#000000" stroke-width="2" pointer-events="none"/><path d="M 73.86 597.14 L 88.14 582.86" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 73.86 582.86 L 88.14 597.14" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80.59 535.5 L 80.59 558 L 80.59 573.98" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 80.59 579.23 L 77.09 572.23 L 80.59 573.98 L 84.09 572.23 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(73.5,545.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="18" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">NO</div></div></foreignObject><text x="9" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">NO</text></switch></g><path d="M 895.5 560.35 L 875.88 560.35 L 854.71 560.35" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 945.5 530 L 895.5 530 L 895.5 590 L 945.5 590" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(898.5,546.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="69" height="27" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div>Not <br /></div><div>implemented</div></div></div></foreignObject><text x="35" y="20" fill="#000000" text-anchor="middle" font-size="12px" font-family="'Helvetica'">[Not supported by viewer]</text></switch></g><path d="M 80.59 93.98 L 80.59 80.35 L 80.59 60" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 80.59 99.23 L 77.09 92.23 L 80.59 93.98 L 84.09 92.23 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="81" cy="30" rx="50" ry="30" fill="#f5f5f5" stroke="#666666" stroke-width="2" pointer-events="none"/><g transform="translate(61.5,23.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="38" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(51, 51, 51); line-height: 1.2; vertical-align: top; width: 39px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">START</div></div></foreignObject><text x="19" y="12" fill="#333333" text-anchor="middle" font-size="12px" font-family="Helvetica">START</text></switch></g><path d="M 639.99 30 L 671.01 30 C 684.54 30 695.5 43.43 695.5 60 C 695.5 76.57 684.54 90 671.01 90 L 639.99 90 C 626.46 90 615.5 76.57 615.5 60 C 615.5 43.43 626.46 30 639.99 30 Z" fill="#f5f5f5" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(642.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="25" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(51, 51, 51); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">END</div></div></foreignObject><text x="13" y="12" fill="#333333" text-anchor="middle" font-size="12px" font-family="Helvetica">END</text></switch></g><path d="M 919.99 743 L 951.01 743 C 964.54 743 975.5 756.43 975.5 773 C 975.5 789.57 964.54 803 951.01 803 L 919.99 803 C 906.46 803 895.5 789.57 895.5 773 C 895.5 756.43 906.46 743 919.99 743 Z" fill="#f5f5f5" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(922.5,766.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="25" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: rgb(51, 51, 51); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">END</div></div></foreignObject><text x="13" y="12" fill="#333333" text-anchor="middle" font-size="12px" font-family="Helvetica">END</text></switch></g></g></svg>